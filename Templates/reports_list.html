<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EquiLink - Reports</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <!-- Include Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Include Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#e3f2fd',
                            100: '#bbdefb',
                            200: '#90caf9',
                            300: '#64b5f6',
                            400: '#42a5f5',
                            500: '#3498db',
                            600: '#2980b9',
                            700: '#1e88e5',
                            800: '#1565c0',
                            900: '#0d47a1',
                        },
                        secondary: '#f50057',
                        success: {
                            50: '#e8f5e9',
                            100: '#c8e6c9',
                            200: '#a5d6a7',
                            300: '#81c784',
                            400: '#66bb6a',
                            500: '#2ecc71',
                            600: '#27ae60',
                            700: '#388e3c',
                            800: '#2e7d32',
                            900: '#1b5e20',
                        },
                        warning: {
                            50: '#fff8e1',
                            100: '#ffecb3',
                            200: '#ffe082',
                            300: '#ffd54f',
                            400: '#ffca28',
                            500: '#f39c12',
                            600: '#ffa000',
                            700: '#ff8f00',
                            800: '#ff6f00',
                            900: '#ff5722',
                        },
                        danger: {
                            50: '#fdecea',
                            100: '#f8c9c5',
                            200: '#f3a59e',
                            300: '#ed8276',
                            400: '#e8584a',
                            500: '#e74c3c',
                            600: '#d32f2f',
                            700: '#c0392b',
                            800: '#b71c1c',
                            900: '#7f0000',
                        },
                        background: '#f5f5f5',
                    },
                    boxShadow: {
                        'custom': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'custom-lg': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.5s ease-out forwards',
                        'bounce-slow': 'bounce 3s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                    }
                }
            }
        }
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
        }
        
        /* Custom styles that complement Tailwind */
        .status-badge {
            @apply inline-flex px-2 py-1 rounded text-xs font-semibold items-center;
        }
        .status-pending {
            @apply bg-warning-500 text-white;
        }
        .status-approved {
            @apply bg-success-500 text-white;
        }
        .status-rejected {
            @apply bg-danger-500 text-white;
        }
        .truncate-id {
            @apply font-mono text-gray-600;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #3498db;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        /* Staggered animation for items */
        .stagger-item {
            opacity: 0;
            transform: translateY(10px);
        }
        
        /* Table hover effect */
        .table-row-hover:hover {
            @apply bg-primary-50;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-200 min-h-screen text-gray-800 p-4 md:p-6">
    <div class="max-w-6xl mx-auto">
        <header class="bg-gradient-to-r from-primary-600 to-primary-800 text-white text-center py-8 px-4 rounded-lg shadow-custom mb-8 transition-all duration-300 hover:shadow-custom-lg animate-fade-in">
            <h1 class="text-4xl font-medium flex items-center justify-center">
                <i class="fas fa-clipboard-list text-white mr-4 text-3xl"></i>
                EquiLink Reports
            </h1>
            <p class="mt-2 text-primary-100 max-w-xl mx-auto">Administrative dashboard to manage and review submitted incident reports</p>
        </header>
        
        <div class="bg-white rounded-lg shadow-custom mb-6 p-6 animate-slide-up">
            <!-- Dashboard Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 stagger-item" style="animation-delay: 100ms;">
                {% set pending_count = reports|selectattr('status', 'equalto', 'pending')|list|length %}
                {% set approved_count = reports|selectattr('status', 'equalto', 'approved')|list|length %}
                {% set rejected_count = reports|selectattr('status', 'equalto', 'rejected')|list|length %}
                
                <div class="bg-primary-50 p-4 rounded-lg border-l-4 border-primary-500 flex items-center shadow-sm">
                    <div class="bg-primary-100 text-primary-700 p-3 rounded-full mr-4">
                        <i class="fas fa-clipboard-list text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500 text-sm">Total Reports</p>
                        <p class="text-2xl font-bold text-primary-700">{{ reports|length }}</p>
                    </div>
                </div>
                
                <div class="bg-warning-50 p-4 rounded-lg border-l-4 border-warning-500 flex items-center shadow-sm">
                    <div class="bg-warning-100 text-warning-700 p-3 rounded-full mr-4">
                        <i class="fas fa-clock text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500 text-sm">Pending Review</p>
                        <p class="text-2xl font-bold text-warning-700">{{ pending_count }}</p>
                    </div>
                </div>
                
                <div class="bg-success-50 p-4 rounded-lg border-l-4 border-success-500 flex items-center shadow-sm">
                    <div class="bg-success-100 text-success-700 p-3 rounded-full mr-4">
                        <i class="fas fa-check-circle text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500 text-sm">Approved Reports</p>
                        <p class="text-2xl font-bold text-success-700">{{ approved_count }}</p>
                    </div>
                </div>
            </div>
        
            <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-6 stagger-item" style="animation-delay: 200ms;">
                <div>
                    <h2 class="text-xl font-medium text-primary-700 flex items-center">
                        <i class="fas fa-tasks mr-2"></i>
                        Report Management
                    </h2>
                    <p class="text-gray-500 text-sm mt-1">Review and manage submitted incident reports</p>
                </div>
                
                <form class="flex flex-col md:flex-row items-start md:items-center gap-3 bg-gray-50 p-3 rounded-lg" method="GET" action="{{ url_for('reports.get_all_reports') }}">
                    <label for="language" class="font-medium flex items-center text-gray-700">
                        <i class="fas fa-language mr-2 text-primary-500"></i>
                        Filter by Language:
                    </label>
                    <div class="relative w-full md:w-auto">
                        <select name="language" id="language" 
                                class="appearance-none pl-4 pr-10 py-2 border border-gray-300 rounded-md bg-white cursor-pointer 
                                       min-w-[180px] w-full focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
                                       transition-all duration-200">
                            <option value="">All Languages</option>
                            <option value="en" {% if filter_language == 'en' %}selected{% endif %}>English</option>
                            <option value="es" {% if filter_language == 'es' %}selected{% endif %}>Español</option>
                            <option value="fr" {% if filter_language == 'fr' %}selected{% endif %}>Français</option>
                            <option value="hi" {% if filter_language == 'hi' %}selected{% endif %}>हिंदी</option>
                            <option value="ta" {% if filter_language == 'ta' %}selected{% endif %}>தமிழ்</option>
                            <option value="ml" {% if filter_language == 'ml' %}selected{% endif %}>മലയാളം</option>
                            <option value="te" {% if filter_language == 'te' %}selected{% endif %}>తెలుగు</option>
                            <option value="kn" {% if filter_language == 'kn' %}selected{% endif %}>ಕನ್ನಡ</option>
                        </select>
                        <div class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-500">
                            <i class="fas fa-chevron-down text-xs"></i>
                        </div>
                    </div>
                    <button type="submit" class="bg-primary-500 hover:bg-primary-600 text-white py-2 px-4 rounded-md transition-all duration-200 w-full md:w-auto shadow-sm hover:shadow flex items-center justify-center">
                        <i class="fas fa-filter mr-2"></i>
                        Apply Filter
                    </button>
                </form>
            </div>
            
            <div class="overflow-x-auto rounded-lg border border-gray-200 stagger-item" style="animation-delay: 300ms;">
                <table class="w-full border-collapse">
                    <thead>
                        <tr>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-hashtag mr-2"></i>
                                    ID
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-tag mr-2"></i>
                                    Type
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    Location
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-calendar-alt mr-2"></i>
                                    Submitted
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-language mr-2"></i>
                                    Language
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Status
                                </div>
                            </th>
                            <th class="sticky top-0 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-left px-4 py-3 font-medium">
                                <div class="flex items-center">
                                    <i class="fas fa-cogs mr-2"></i>
                                    Actions
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for report in reports %}
                        <tr class="border-b border-gray-200 transition-all duration-200 table-row-hover">
                            <td class="px-4 py-3"><span class="truncate-id">{{ report.id[:8] }}...</span></td>
                            <td class="px-4 py-3">{{ report.type }}</td>
                            <td class="px-4 py-3">{{ report.location or "—" }}</td>
                            <td class="px-4 py-3">{{ report.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                            <td class="px-4 py-3">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    {{ report.language }}
                                </span>
                            </td>
                            <td class="px-4 py-3">
                                {% if report.status == 'pending' %}
                                <span class="status-badge status-pending">
                                    <i class="fas fa-clock mr-1"></i>
                                    {{ report.status }}
                                </span>
                                {% elif report.status == 'approved' %}
                                <span class="status-badge status-approved">
                                    <i class="fas fa-check-circle mr-1"></i>
                                    {{ report.status }}
                                </span>
                                {% else %}
                                <span class="status-badge status-rejected">
                                    <i class="fas fa-times-circle mr-1"></i>
                                    {{ report.status }}
                                </span>
                                {% endif %}
                            </td>
                            <td class="px-4 py-3">
                                <div class="flex gap-2">
                                    {% if not report.finalized %}
                                        <a href="{{ url_for('reports.finalize_view', report_id=report.id) }}" 
                                           class="bg-primary-500 hover:bg-primary-600 text-white py-1 px-3 rounded-md text-sm transition-all duration-200 flex items-center shadow-sm hover:shadow hover:-translate-y-0.5">
                                           <i class="fas fa-check-double mr-1"></i>
                                           Finalize
                                        </a>
                                    {% else %}
                                        <a href="{{ url_for('reports.view_report', report_id=report.id) }}" 
                                           class="bg-primary-500 hover:bg-primary-600 text-white py-1 px-3 rounded-md text-sm transition-all duration-200 flex items-center shadow-sm hover:shadow hover:-translate-y-0.5">
                                           <i class="fas fa-eye mr-1"></i>
                                           View
                                        </a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                        
                        {% if not reports %}
                        <tr>
                            <td colspan="7" class="px-4 py-12 text-center">
                                <div class="flex flex-col items-center justify-center">
                                    <i class="fas fa-folder-open text-gray-400 text-5xl mb-3"></i>
                                    <p class="text-gray-500 text-lg">No reports found</p>
                                    <p class="text-gray-400 text-sm mt-1">Try adjusting your filter criteria</p>
                                </div>
                            </td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Footer Section -->
        <footer class="text-center text-gray-500 text-sm py-4 stagger-item" style="animation-delay: 400ms;">
            <p>EquiLink Admin Dashboard &copy; 2024</p>
        </footer>
    </div>
    
    <!-- Enhanced animations and interactivity -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Animate staggered items
            const staggerItems = document.querySelectorAll('.stagger-item');
            staggerItems.forEach((item, index) => {
                setTimeout(() => {
                    item.style.animation = 'fadeIn 0.5s ease forwards, slideUp 0.5s ease forwards';
                }, 100 + (index * 100));
            });
            
            // Animate table rows with staggered delay
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach((row, index) => {
                row.style.opacity = '0';
                row.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    row.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                    row.style.opacity = '1';
                    row.style.transform = 'translateY(0)';
                }, 400 + index * 50); // Start after other elements are loaded
            });
            
            // Add tooltips to action buttons
            const actionButtons = document.querySelectorAll('td a');
            actionButtons.forEach(button => {
                const originalText = button.innerHTML;
                const actionType = button.textContent.trim();
                
                button.addEventListener('mouseenter', () => {
                    if (actionType.includes('Finalize')) {
                        button.setAttribute('title', 'Review and approve/reject this report');
                    } else if (actionType.includes('View')) {
                        button.setAttribute('title', 'View complete report details');
                    }
                });
            });
            
            // Add subtle pulse effect to pending status badges
            const pendingBadges = document.querySelectorAll('.status-pending');
            pendingBadges.forEach(badge => {
                badge.classList.add('animate-pulse');
            });
        });
    </script>
</body>
</html>
